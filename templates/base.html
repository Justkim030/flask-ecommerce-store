<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Tech Accessories Kenya{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script>
        // Apply theme from localStorage on page load to prevent flashing
        (function() {
            const theme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
</head>
<body>
    {# The bg-white class is now controlled by CSS variables, but we keep navbar-light for text color hints #}
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('home') }}">
                <i class="fas fa-store me-2"></i>
                Tech Accessories Kenya
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="navbar-nav ms-auto d-flex align-items-center">
                    <a class="nav-link" href="#">Help Center</a>
                    <a class="nav-link" href="{{ url_for('cart') }}">
                        <i class="fas fa-shopping-cart"></i> Cart
                        {% if cart_item_count > 0 %}
                            <span class="badge rounded-pill bg-danger ms-1">{{ cart_item_count }}</span>
                        {% endif %}
                    </a>
                    {% if session.username %}
                        {# This block is for any logged-in user #}
                        {% if session.is_admin %}
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('admin.index') }}">Admin Panel</a>
                            </li>
                        {% endif %}
                        <span class="navbar-text me-2">
                            <i class="fas fa-user me-1"></i>{{ session.username }}
                        </span>
                        <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                    {% else %}
                        {# This block is for logged-out users #}
                        <a class="nav-link" href="{{ url_for('login') }}">Login</a>
                        <a class="nav-link" href="{{ url_for('register') }}">Register</a>
                    {% endif %}
                    <button id="theme-switcher" class="theme-switcher ms-3">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>
    <div class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </div>

    <footer class="info-section-wrapper mt-5 py-5">
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                    <h5>Help Center</h5>
                    <ul class="list-unstyled">
                        <li><a href="#">Help Center</a></li>
                        <li><a href="#">Contact Us</a></li>
                        <li><a href="#">How to shop on Tech Kenya</a></li>
                        <li><a href="#">Shipping & Delivery</a></li>
                        <li><a href="#">Return Policy</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Shopping Guide</h5>
                    <ul class="list-unstyled">
                        <li><a href="#">How to Buy</a></li>
                        <li><a href="#">Track Your Order</a></li>
                        <li><a href="#">Returns & Refunds</a></li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h5>About Tech Kenya Accessories</h5>
                    <p>Tech Kenya Accessories is your number one online shopping site in Kenya for computer electronics and accessories. We are an online store where you can purchase all your laptops, desktops, peripherals, and gadget needs. We pride ourselves on delivering quality products and excellent customer service right to your doorstep.</p>
                </div>
            </div>
            <hr class="my-4">
            <div class="text-center text-muted">
                <p class="mb-0">&copy; <script>document.write(new Date().getFullYear())</script> Tech Accessories Kenya. All Rights Reserved. | Website built by <a href="https://justkim99.com" target="_blank" rel="noopener noreferrer" class="text-reset">justkim99.com</a></p>
            </div>
        </div>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Theme switcher logic
        document.addEventListener('DOMContentLoaded', function () {
            const themeSwitcher = document.getElementById('theme-switcher');
            const icon = themeSwitcher.querySelector('i');
            const doc = document.documentElement;

            // Set initial icon based on current theme
            if (doc.getAttribute('data-theme') === 'dark') {
                icon.classList.replace('fa-moon', 'fa-sun');
            }

            themeSwitcher.addEventListener('click', function () {
                const currentTheme = doc.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                doc.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);

                icon.classList.toggle('fa-moon');
                icon.classList.toggle('fa-sun');
            });
        });
    </script>
</body>
</html>
